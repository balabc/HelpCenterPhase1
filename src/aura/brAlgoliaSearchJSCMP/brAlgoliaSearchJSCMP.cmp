<aura:component >
    <aura:attribute name="brFilter" type="Map" />
    <aura:attribute name="categories" type="Map"/>
    <aura:attribute name="hasData" type="String" default="off"/>
    <aura:attribute name="searchText" type="String"/> 
    
    <aura:handler name="eventFromBrAlgoliaFilter" event="c:brAlgoliaFilterEvent" action="{!c.onChangeFilter}"/>
    
    <ltng:require scripts='/resource/instantsearch/algoliasearch.min.js' afterScriptsLoaded="{!c.jsLoaded}" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:handler name="change" value="{!v.brFilter}" action="{!c.searchChange}"/>
    
    <div class="right_content">
        <div class="content_search">
            <div class="search_input">	    
                <ui:inputText label="" updateOn="keyup" class="field" value="{!v.searchText}" keyup="{!c.searchKeyUp}" change="{!c.searchChange}"/>
            </div>           
            <div class="search_result search_categories" data-is="{!v.hasData}">
                <div class="left_content" >
                    <c:brAlgoliaFilterJSCMP />
                </div>    
                <div class="result_content" >
                    <aura:iteration items="{!v.categories}" var="category">
                        <div class="search_category">
                            <div class="category_title">
                                <aura:unescapedHtml value="{!category.name}"/>
                            </div>
                            <div class="category_items">
                                <aura:iteration items="{!category.items}" var="item">
                                    <div class="category_item">
                                        <div class="item_left"><aura:unescapedHtml value="{!item.left}"/></div>
                                        <div class="item_right">
                                            <aura:iteration items="{!item.right}" var="line">
                                                <aura:unescapedHtml value="{!line}"/>
                                            </aura:iteration>
                                        </div>
                                    </div>
                                </aura:iteration>
                            </div>
                        </div>
                    </aura:iteration>
                </div>
            </div>
        </div>
    </div>
</aura:component>